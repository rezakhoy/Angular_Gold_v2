<div class="container-fluid">

  <div class="row" *ngFor="let child of commandChildren ">
    <div class="card">
      <div class="card-body">
        <div class="d-flex flex-wrap border-bottom pb-2">
          <h4>
            <span  *permissionAnyOf="['admin', 'acc']" >{{child.name }} -- {{child.amount | number}}</span>
            <span>  شماره حساب : {{child.accountNumber}}</span>
            <span>  به نام :{{child.accountOwnerName}} </span>
            <span>  قابل پرداخت : {{child.amount}} </span>
          </h4>
          <div class="ms-auto mt-auto">
          <button class="btn  btn-primary"  (click)="makePayInfo(child, payInfoModal)">ثبت فیش</button>
          </div>


        </div>
        <div class="row">

            <div class="col-md-3"  *ngFor="let pay of child.payInformationList ">
              <div class="card ">
                <div class="card-body ">
                  <h4 class="card-title"> مبلغ : {{pay.amount | number}}  </h4>
                  <p class="card-title-desc">  شرح : {{pay.description}}  </p>
                  <div class="row text-center ">
                    <div class="col-6">
                      <div>
                        <span *ngIf="pay.status === 'REQUEST'" class="badge font-size-14 bg-info mb-1 " > در انتظار </span>
                        <span *ngIf="pay.status === 'UNCONFIRM'" class="badge font-size-14 bg-danger  mb-1">تایید نشده</span>
                        <span *ngIf="pay.status === 'CONFIRM'" class="badge font-size-14 bg-success  mb-1">تایید شده</span>

                        <div class="img-fluid">
                          <img [src]="transform(pay.image)" (click)="showLightbox(pay.image)" width="145"/>
                        </div>

                        <div>
                          <div class="btn-group btn-group-example mt-2" role="group">
                            <button type="button" class="btn btn-primary w-xs" (click)="confirmPay(pay.id)"><i
                              class="mdi mdi-thumb-up" ></i></button>
                            <button type="button" class="btn btn-danger w-xs" (click)="unConfirmPay(pay.id)"><i
                              class="mdi mdi-thumb-down"></i></button>
                          </div>
                        </div>
                        <ng-image-fullscreen-view
                          [images]="imageObject"
                          [show]="showFlag"
                          [direction]="'rtl'"
                          [closeText]="'بستن'"
                          (click)="onclick($event)"
                        ></ng-image-fullscreen-view>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

      </div>
    </div>
  </div>


  </div>


<!--**********************************
                modal
***********************************-->
    <ng-template #payInfoModal let-modal>
      <div class="modal-header">

        <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
   <div class="modal-body">
     <form [formGroup]="payInfoForm" >
       <!--        Progress Bar-->
       <!--        <div class="progress form-group" *ngIf="percentDone">-->
       <!--          <div class="progress-bar progress-bar-striped bg-success" role="progressbar"-->
       <!--               [style.width.%]="percentDone">-->
       <!--          </div>-->
       <!--        </div>-->
       <div class="row mb-5">
         <div class="col-md-6">
           <label for="amount" class="form-label">مبلغ درخواست: </label>
           <input type="text" formControlName="amount" autocomplete="off" currencyMask  ngbAutofocus class="form-control" id="amount">
         </div>
         <div class="col-md-6">
           <label for="receiptNumber" class="form-label">شماره فیش: </label>
           <input type="text" formControlName="receiptNumber"    class="form-control" id="receiptNumber">
         </div>
         <div class="col-md-12">
           <label for="description" class="form-label"> توضیحات: </label>
           <input type="text" formControlName="description"    class="form-control" id="description">
         </div>
       </div>
       <div class="form-group">
         <div class="preview " *ngIf="preview && preview !== null">
           <img [src]="preview" [alt]="payInfoForm.value.name" width="150">
         </div>
       </div>

       <div class="form-group">
         <input type="file" (change)="uploadFile($event)">
       </div>

       <div class="row">
         <button class="btn btn-info btn-block mt-5" (click)="submitForm(); modal.close() ">ثبت فیش</button>
       </div>
     </form>
   </div>

    </ng-template>
